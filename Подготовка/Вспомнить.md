* [x] Resttemplate
      не подходит под реактивную архитектуру; плохо масштабируется
      Изучить **WebClient** - новая версия 
* [x] Eventual Consistency, latency, Saga Pattern, circuit breaker, API Gateway
* [x] @LoadBalance
* [x] Mapper
* [ ] @OneToMany
* [x] openApiModel\openApiEndpoint
* [ ] log\ Slf4j
* [x] @Transactional
* [ ] RedisTemplate
* [ ] PostgreSQL
* [ ] Поднятие Docker 
* [ ] DTO
* [ ] Lombok
* [ ] Autowired/Constructor 
* [ ] Git, работа с ветками в нем 
* [ ] ResponceEntity 
* [ ] Interception 
* [ ] OpenFeign
* [ ] Stream
* [ ] kafka

# Лор
#resttemplate
RestTemplate — это синхронный HTTP-клиент Spring для работы с REST-сервисами. Чаще всего используется для интеграций между микросервисами и внешними API. Сейчас находится в maintenance-режиме, но широко применяется в существующих коммерческих проектах. Для сложных сценариев используется метод `exchange()` с кастомной обработкой ошибок и интерсепторами.

#архитектура #микросервисы
Микросервис — это независимо развёртываемый компонент, реализующий один бизнес-контекст, со своей моделью данных и ответственностью.
Для каждого сервиса используется своя схема базы, хотя может быть развернута внутри PostgreSQL
Микросервисы дают независимость и масштабируемость, но усложняют систему. В проде важно использовать таймауты, circuit breaker’ы и событийное взаимодействие, иначе система становится нестабильной.
#архитектура #микросервисы
**Eventual Consistency** -  Система не обязана быть консистентной (целостной в данных, работе) в каждый момент времени,  но при отсутствии новых изменений она придёт к консистентному состоянию.
Eventual consistency — это не «всё асинхронно»,  
это **отказ от глобального ожидания ради устойчивости**.
**API Gatewat** - единая точка входа для клиента в микросервисы. Уменьшает сложность, но увеличивает шанс падения.
**Circuit Breaker** - следит за каскадным падением сервисов и перезапускает их, закрывает поток запросов.
**Saga Pattern** - оркестрация запросов, уход от атомарности
Атомарность (целостное выполнение или не выполнение операции). 
Есть Choreography Saga (нет координатора, сервисы сами ловят запросы) и Orchestration Saga (координатор руководит шагами)
```
API Gateway 
   ↓
REST / Events
   ↓
Latency → Timeouts → Circuit Breaker
   ↓
Eventual Consistency
   ↓
Saga Pattern
```

#responce_entity 
**ResponseEntity** позволяет явно управлять HTTP-ответом: статусом, заголовками и телом. Используется в контроллерах и обработчиках ошибок для формирования корректного REST-контракта и гибкой реакции на бизнес-сценарии.
#mapper 
Мы используем Mapstruct и lombok, чтобы упрощать написание классов и конвертацию экземпляра из одного класса в другой. Так из Entity можно получить DTO. В случае, если у нас есть вложенные элементы используется 
```
@Mapping(source = "author.id", target = "authorId")
```
Над самим классом используется аннотация @Mapper(componentModel = "spring")
#log
Стандартная реализация Java в логах - это @Slf4j + Logback


```
            ┌───────────────┐
            │   Client      │
            └───────┬───────┘
                    │
             ┌──────▼──────┐
             │ API Gateway │
             └──────┬──────┘
        ┌───────────┼────────────┐
        │           │            │
┌───────▼──────┐ ┌──▼────────┐ ┌─▼──────────┐
│ Auth Service │ │ Post Svc   │ │ User Svc   │
└──────────────┘ └────┬───────┘ └────┬───────┘
                       │              │
                ┌──────▼──────┐       │
                │ PostgreSQL  │       │
                │  (Posts)    │       │
                └──────┬──────┘       │
                       │              │
                   ┌───▼───┐          │
                   │ Kafka │◄─────────┘
                   └───┬───┘
                       │
               ┌───────▼────────┐
               │ Feed Service   │
               └───────┬────────┘
                       │
              ┌────────▼─────────┐
              │ Redis / Cassandra│
              │    (Feeds)       │
              └──────────────────┘

```

#бд
Шардирование - расположение репликаций БД в разных сервисах. 
PostgreSQL имеет бесплатную лицензию в отличии от MSSQL, кроссплатформенная, а не только под Windows, легче реплицировать, и в клауде работать.

**Lost Update** (Read uncommited) - решается в большей части современных БД. При откате одной транзакции, откатятся и изменения второй, которая шла параллельно.
**Dirty Read** (Read commit) - транзакция первая изменяет значения, но падает. Вторая считывает измененное значение до падения и работает с ней.
**Non-repeated read** (Repeated read)- в момент долгого выполнения первой транзакции, вторая успевает изменить данные, из-за чего работа первой также меняется. ЧАСТО ВСТРЕЧАЕТСЯ 
**Phantom read** ()- первая транзакция берет данные, вторая изменяет (удаляет) их, из-за чего работа в первое падает.

ACID — это набор фундаментальных свойств (Атомарность, Согласованность, Изолированность, Долговечность), обеспечивающих надежность и целостность транзакций в реляционных базах данных. Они гарантируют корректность данных при сбоях, ошибках или одновременных операциях, предотвращая их повреждение. 

- **[Атомарность](https://www.google.com/search?q=%D0%90%D1%82%D0%BE%D0%BC%D0%B0%D1%80%D0%BD%D0%BE%D1%81%D1%82%D1%8C&oq=ACID&gs_lcrp=EgZjaHJvbWUqBwgAEAAYjwIyBwgAEAAYjwIyDAgBEEUYORixAxiABDIHCAIQABiABDIHCAMQABiABDIHCAQQABiABDIHCAUQABiABDIHCAYQABiABDIGCAcQRRg90gEHOTE5ajBqMagCALACAA&sourceid=chrome&ie=UTF-8&ved=2ahUKEwiOpvjir6uSAxUkR_EDHZwiO_4QgK4QegYIAQgAEAY) (Atomicity):** Транзакция выполняется полностью или не выполняется вовсе.
- **[Согласованность](https://www.google.com/search?q=%D0%A1%D0%BE%D0%B3%D0%BB%D0%B0%D1%81%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D1%81%D1%82%D1%8C&oq=ACID&gs_lcrp=EgZjaHJvbWUqBwgAEAAYjwIyBwgAEAAYjwIyDAgBEEUYORixAxiABDIHCAIQABiABDIHCAMQABiABDIHCAQQABiABDIHCAUQABiABDIHCAYQABiABDIGCAcQRRg90gEHOTE5ajBqMagCALACAA&sourceid=chrome&ie=UTF-8&ved=2ahUKEwiOpvjir6uSAxUkR_EDHZwiO_4QgK4QegYIAQgAEAg) (Consistency):** Транзакция переводит БД из одного корректного состояния в другое.
- **[Изолированность](https://www.google.com/search?q=%D0%98%D0%B7%D0%BE%D0%BB%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D1%81%D1%82%D1%8C&oq=ACID&gs_lcrp=EgZjaHJvbWUqBwgAEAAYjwIyBwgAEAAYjwIyDAgBEEUYORixAxiABDIHCAIQABiABDIHCAMQABiABDIHCAQQABiABDIHCAUQABiABDIHCAYQABiABDIGCAcQRRg90gEHOTE5ajBqMagCALACAA&sourceid=chrome&ie=UTF-8&ved=2ahUKEwiOpvjir6uSAxUkR_EDHZwiO_4QgK4QegYIAQgAEAo) (Isolation):** Параллельные транзакции не влияют друг на друга.
- **[Долговечность](https://www.google.com/search?q=%D0%94%D0%BE%D0%BB%D0%B3%D0%BE%D0%B2%D0%B5%D1%87%D0%BD%D0%BE%D1%81%D1%82%D1%8C&oq=ACID&gs_lcrp=EgZjaHJvbWUqBwgAEAAYjwIyBwgAEAAYjwIyDAgBEEUYORixAxiABDIHCAIQABiABDIHCAMQABiABDIHCAQQABiABDIHCAUQABiABDIHCAYQABiABDIGCAcQRRg90gEHOTE5ajBqMagCALACAA&sourceid=chrome&ie=UTF-8&ved=2ahUKEwiOpvjir6uSAxUkR_EDHZwiO_4QgK4QegYIAQgAEAw) (Durability):** Успешно завершенная транзакция сохраняется даже при сбое питания.